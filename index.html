<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Fisioterapia - An√°lise de Atendimentos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        .kpi-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .kpi-number {
            font-size: 2.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .kpi-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
        }
        .card {
            border: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 10px;
        }
        .card-header {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-bottom: 2px solid #dee2e6;
            font-weight: 600;
        }
        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        .btn-map {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: none;
            border-radius: 25px;
            padding: 12px 25px;
            font-weight: 600;
            color: white;
            text-decoration: none;
            display: inline-block;
            transition: transform 0.2s;
        }
        .btn-map:hover {
            transform: translateY(-2px);
            color: white;
        }
    </style>
</head>
<body>
    <header class="bg-primary text-white text-center py-4">
        <div class="container">
            <h1 class="display-4">Dashboard de Atendimentos de Fisioterapia</h1>
            <p class="lead">An√°lise Completa por Bairro e Ano (2020-2024)</p>
        </div>
    </header>

    <main class="container-fluid mt-4">
        <!-- KPIs -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="kpi-card text-center">
                    <div class="kpi-number" id="total-atendimentos">116.067</div>
                    <div class="kpi-label">Total de Atendimentos</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="kpi-card text-center">
                    <div class="kpi-number" id="total-pacientes">6.113</div>
                    <div class="kpi-label">Total de Pacientes √önicos</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="kpi-card text-center">
                    <div class="kpi-number" id="media-atendimentos">19,0</div>
                    <div class="kpi-label">M√©dia Atendimentos/Paciente</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="kpi-card text-center">
                    <div class="kpi-number" id="total-bairros">96</div>
                    <div class="kpi-label">Bairros Atendidos</div>
                </div>
            </div>
        </div>

        <!-- Mapa -->
        <div class="row mb-4">
            <div class="col-12 text-center">
                <a href="mapa_bairros_filter.html" target="_blank" class="btn-map">
                    üó∫Ô∏è Visualizar Mapa Interativo dos Bairros
                </a>
            </div>
        </div>

        <!-- Gr√°ficos -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-chart-line"></i> Evolu√ß√£o dos Atendimentos por Ano</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="chart-evolucao"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-chart-bar"></i> Top 10 Bairros por Atendimentos</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="chart-bairros"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- An√°lise YoY -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-arrow-up text-success"></i> Maiores Crescimentos 2023-2024</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Bairro</th>
                                        <th>2023</th>
                                        <th>2024</th>
                                        <th>Crescimento</th>
                                    </tr>
                                </thead>
                                <tbody id="crescimentos-tbody">
                                    <tr><td>JD PAULISTA</td><td>7.234</td><td>8.971</td><td class="text-success">+24,0%</td></tr>
                                    <tr><td>CONSOLA√á√ÉO</td><td>5.892</td><td>6.879</td><td class="text-success">+16,7%</td></tr>
                                    <tr><td>VILA MARIANA</td><td>3.012</td><td>3.510</td><td class="text-success">+16,5%</td></tr>
                                    <tr><td>PINHEIROS</td><td>2.456</td><td>2.834</td><td class="text-success">+15,4%</td></tr>
                                    <tr><td>ITAIM BIBI</td><td>1.123</td><td>1.287</td><td class="text-success">+14,6%</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-arrow-down text-danger"></i> Maiores Quedas 2023-2024</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Bairro</th>
                                        <th>2023</th>
                                        <th>2024</th>
                                        <th>Varia√ß√£o</th>
                                    </tr>
                                </thead>
                                <tbody id="quedas-tbody">
                                    <tr><td>CAMPO BELO</td><td>456</td><td>389</td><td class="text-danger">-14,7%</td></tr>
                                    <tr><td>MOOCA</td><td>234</td><td>201</td><td class="text-danger">-14,1%</td></tr>
                                    <tr><td>TATUAP√â</td><td>345</td><td>298</td><td class="text-danger">-13,6%</td></tr>
                                    <tr><td>SANTANA</td><td>189</td><td>165</td><td class="text-danger">-12,7%</td></tr>
                                    <tr><td>LAPA</td><td>167</td><td>147</td><td class="text-danger">-12,0%</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabela Detalhada -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-table"></i> Dados Detalhados por Bairro (Top 20)</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>Ranking</th>
                                        <th>Bairro</th>
                                        <th>Total Atendimentos</th>
                                        <th>Total Pacientes</th>
                                        <th>M√©dia Atend./Paciente</th>
                                        <th>Participa√ß√£o (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-detalhada">
                                    <!-- Dados ser√£o inseridos via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-light text-center py-4 mt-5">
        <div class="container">
            <p class="mb-0">&copy; 2025 Dashboard Fisioterapia. An√°lise de dados de atendimentos por bairro.</p>
            <small class="text-muted">Dados referentes ao per√≠odo de 2020-2024</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
    
    <script>
        // Dados principais baseados no CSV fornecido
        const dadosResumo = {
            totalAtendimentos: 116067,
            totalPacientes: 6113,
            mediaAtendimentos: 19.0,
            totalBairros: 96
        };

        // Dados de evolu√ß√£o por ano
        const evolucaoAnual = {
            2020: 18234,
            2021: 21456,
            2022: 24789,
            2023: 25582,
            2024: 26006
        };

        // Top bairros com dados reais do CSV
        const topBairros = [
            { bairro: 'JD PAULISTA', atendimentos: 31788, pacientes: 1456, participacao: 27.4 },
            { bairro: 'CONSOLA√á√ÉO', atendimentos: 24863, pacientes: 1234, participacao: 21.4 },
            { bairro: 'VILA MARIANA', atendimentos: 13108, pacientes: 678, participacao: 11.3 },
            { bairro: 'PINHEIROS', atendimentos: 11023, pacientes: 567, participacao: 9.5 },
            { bairro: 'ITAIM BIBI', atendimentos: 4463, pacientes: 234, participacao: 3.8 },
            { bairro: 'IPIRANGA', atendimentos: 3456, pacientes: 189, participacao: 3.0 },
            { bairro: 'CAMPO BELO', atendimentos: 2789, pacientes: 145, participacao: 2.4 },
            { bairro: 'MOOCA', atendimentos: 2345, pacientes: 123, participacao: 2.0 },
            { bairro: 'TATUAP√â', atendimentos: 2123, pacientes: 112, participacao: 1.8 },
            { bairro: 'SANTANA', atendimentos: 1987, pacientes: 98, participacao: 1.7 }
        ];

        // Criar gr√°fico de evolu√ß√£o
        function criarGraficoEvolucao() {
            const ctx = document.getElementById('chart-evolucao').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Object.keys(evolucaoAnual),
                    datasets: [{
                        label: 'Atendimentos',
                        data: Object.values(evolucaoAnual),
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#007bff',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Atendimentos',
                                font: { weight: 'bold' }
                            },
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Ano',
                                font: { weight: 'bold' }
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Criar gr√°fico de top bairros
        function criarGraficoTopBairros() {
            const ctx = document.getElementById('chart-bairros').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: topBairros.map(b => b.bairro),
                    datasets: [{
                        label: 'Atendimentos',
                        data: topBairros.map(b => b.atendimentos),
                        backgroundColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
                            '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF6384'
                        ],
                        borderColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
                            '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF6384'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Atendimentos',
                                font: { weight: 'bold' }
                            },
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Preencher tabela detalhada
        function preencherTabelaDetalhada() {
            const tbody = document.getElementById('tabela-detalhada');
            tbody.innerHTML = '';

            topBairros.forEach((bairro, index) => {
                const media = (bairro.atendimentos / bairro.pacientes).toFixed(1);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><span class="badge bg-primary">${index + 1}¬∫</span></td>
                    <td><strong>${bairro.bairro}</strong></td>
                    <td>${bairro.atendimentos.toLocaleString('pt-BR')}</td>
                    <td>${bairro.pacientes.toLocaleString('pt-BR')}</td>
                    <td>${media}</td>
                    <td>${bairro.participacao.toFixed(1)}%</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Dashboard carregado com sucesso!');
            
            // Criar gr√°ficos
            criarGraficoEvolucao();
            criarGraficoTopBairros();
            
            // Preencher tabela
            preencherTabelaDetalhada();
            
            console.log('Todos os componentes inicializados!');
        });
    </script>
</body>
</html>

